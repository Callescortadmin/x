"use strict";var TWITTER_USERNAME='envato';$(function(){$("#location").autocomplete({autoFocus:true,source: "/autocomplete.new.php",minLength:2,select:function(event,ui ){$("#location").val(ui.item.value);document.search.submit();}});});$('.i-check, .i-radio').iCheck({checkboxClass:'i-check',radioClass:'i-radio'});$(function(){$('.countdown').each(function(){var count=$(this);$(this).countdown({zeroCallback:function(options){var newDate=new Date(),newDate=newDate.setHours(newDate.getHours()+130);$(count).attr("data-countdown",newDate);$(count).countdown({unixFormat:true});}});});});$('.carousel').carousel({interval:6000});$("body").fitVids();if($('body').hasClass('sticky-search')){var theLoc=$('.search-area').position().top;if($('body').hasClass('sticky-header')){var header_h=$('header.main').outerHeight();}else{header_h=0;}$(window).scroll(function(){if(theLoc>=$(window).scrollTop()){if($('.search-area').hasClass('fixed')){$('.search-area').removeClass('fixed').css({top:0});}}else{if(!$('.search-area').hasClass('fixed')){$('.search-area').addClass('fixed').css({top:header_h});}}});}if($('body').hasClass('sticky-header')){var theLoc=$('header.main').position().top;$(window).scroll(function(){if(theLoc>=$(window).scrollTop()){if($('header.main').hasClass('fixed')){$('header.main').removeClass('fixed');}}else{if(!$('header.main').hasClass('fixed')){$('header.main').addClass('fixed');}}});}$("#price-slider").ionRangeSlider({min:130,max:575,type:'double',prefix:"$",prettify:false,hasGrid:false});$('#flexnav').flexNav();$('.popup-text').magnificPopup({removalDelay:500,closeBtnInside:true,callbacks:{beforeOpen:function(){this.st.mainClass=this.st.el.attr('data-effect');}},midClick:true});$('.popup-iframe').magnificPopup({dispableOn:700,type:'iframe',removalDelay:160,mainClass:'mfp-fade',preloader:false});$('#star-rating > li').each(function(){var list=$(this).parent(),listItems=list.children(),itemIndex=$(this).index();$(this).hover(function(){for(var i=0;i<listItems.length;i++){if(i<=itemIndex){$(listItems[i]).addClass('hovered');}else{break;}};$(this).click(function(){for(var i=0;i<listItems.length;i++){if(i<=itemIndex){$(listItems[i]).addClass('selected');}else{$(listItems[i]).removeClass('selected');}};$('#star').val(itemIndex+1);});},function(){listItems.removeClass('hovered');});});$('[data-toggle="tooltip"]').tooltip();$("#twitter").tweet({username:TWITTER_USERNAME,count:3});$("#twitter-ticker").tweet({username:TWITTER_USERNAME,page:1,count:20});$('#only_new_checkbox').on('ifChecked',function(event){$('#only_new').val(1);var url=current_url.replace("Index.php","index.php");if(url.indexOf("only_new=")>-1){url=url.replace(/only_new=\d*/,"only_new=1");}else if(url.match(/index\.php\?$/i))url=url+"only_new=1";else if(url.indexOf("index.php")==-1)url=url+"index.php?only_new=1";else
url=url+"&only_new=1";url=url.replace(/p=\d+/,"");location.href=url;}).on('ifUnchecked',function(event){$('#only_new').val(0);var url=current_url.replace("Index.php","index.php");if(url.indexOf("only_new=")>-1){url=url.replace(/only_new=\d*/,"only_new=0");}else if(url.match(/index\.php\?$/))url=url+"only_new=0";else if(url.indexOf("index.php")==-1)url=url+"index.php?only_new=0";else
url=url+"&only_new=0";location.href=url;});$(".cart-item-plus").click(function(){var currentVal=parseInt($(this).prev(".cart-quantity").val());if(!currentVal||currentVal==""||currentVal=="NaN")currentVal=0;$(this).prev(".cart-quantity").val(currentVal+1);});$(".cart-item-minus").click(function(){var currentVal=parseInt($(this).next(".cart-quantity").val());if(currentVal=="NaN")currentVal=0;if(currentVal>0){$(this).next(".cart-quantity").val(currentVal-1);}});$('.form-group-cc-number input').payment('formatCardNumber');$('.form-group-cc-date input').payment('formatCardExpiry');$('.form-group-cc-cvc input').payment('formatCardCVC');if(($('#map-canvas').length)&&typeof GOOGLE_MAP_LAT!='undefined'){var map,service;jQuery(function($){$(document).ready(function(){var latlng=new google.maps.LatLng(GOOGLE_MAP_LAT,GOOGLE_MAP_LNG);var myOptions={zoom:14,center:latlng,mapTypeId:google.maps.MapTypeId.ROADMAP};map=new google.maps.Map(document.getElementById("map-canvas"),myOptions);var marker=new google.maps.Marker({position:latlng,map:map});marker.setMap(map);$('a[href="#google-map-tab"]').on('shown.bs.tab',function(e){google.maps.event.trigger(map,'resize');map.setCenter(latlng);});});});}$('.bg-parallax').each(function(){var $obj=$(this);$(window).scroll(function(){var animSpeed;if($obj.hasClass('bg-blur')){animSpeed=10;}else{animSpeed=15;}var yPos=-($(window).scrollTop()/animSpeed);var bgpos='50% '+yPos+'px';$obj.css('background-position',bgpos);});});$(document).ready(function(){if($('#main-footer').length>0){var docHeight=$(window).height();var footerHeight=$('#main-footer').height();var footerTop=$('#main-footer').position().top+footerHeight;if(footerTop<docHeight){$('#main-footer').css('margin-top',(docHeight-footerTop)+'px');}}if(($('.ui-date').length)){$(".ui-date").datepicker({dateFormat:'yy-mm-dd',changeMonth:true,changeYear:true,constrainInput:true})}});$('#popup-gallery').each(function(){$(this).magnificPopup({delegate:'a.popup-gallery-image',type:'image',gallery:{enabled:true}});});$('#popup-gallery').each(function(){$(this).magnificPopup({delegate:'a.popup-gallery-image',type:'image',gallery:{enabled:true}});});$('.popup-image').magnificPopup({type:'image'});$(window).load(function(){if($(window).width()>992){$('#masonry').masonry({itemSelector:'.col-masonry'});}});$('.nav-coupon-category-left > li > a.sub').click(function(){var wWidth=$(window).width();if(wWidth<=992){if($(this).next('ul').is(":visible")==true){$(this).next('ul').stop().slideUp();return false;}else{$('.nav-coupon-category-left > li > ul').stop().slideUp();$(this).next('ul').stop().slideDown();return false;}}});$(window).resize(function(){var wWidth=$(window).width();if(wWidth>992){$('.nav-coupon-category-left > li > ul').removeAttr('style');}});$('.product-thumb').click(function(e){e.stopPropagation();if($(this).attr('data-target')=="_self")location.href=$(this).attr('data-href');else
window.open($(this).attr('data-href'));});$('.product-thumb a').click(function(e){e.stopPropagation();});$('.toggle-icon').click(function(e){e.stopPropagation();if($(this).nextAll().hasClass('d-block')){$('.product-social-list li').removeClass('d-block');$('.toggle-icon i').removeClass('fa-hand-o-right').addClass('fa-hand-o-left');}else{$('.product-social-list li').removeClass('d-block');$('.toggle-icon i').removeClass('fa-hand-o-right').addClass('fa-hand-o-left');$(this).find('i').removeClass('fa-hand-o-left').addClass('fa-hand-o-right');$(this).nextAll().addClass('d-block');}});$('#change-select').parent().append('<ul id="newyearfilter" name="yearfilter"></ul>');$('#change-select option').each(function(){$('#newyearfilter').append('<li value="'+$(this).val()+'" onclick="change_city($(this).val(),$(this).text());">'+$(this).text()+'</li>');});$('#change-select').remove();$('#newyearfilter').attr('id','change-select');$('.product-thumb .product-title a').dotdotdot();function change_city(val,text){$('#city_field').text(text);$('#city').val(val);$('#city_name').val(text);document.search.submit();}function registaClick(idpromocao){$.ajax({type:"POST",url:"/registaClick.php",data:"id="+idpromocao});}function regist_favorite(id){var message=$.ajax({type:"POST",url:"/regist_favorite.php",async:false,data:"id="+id}).responseText;alert(message);}var request;function detect_geo_by_address(){try{request=new XMLHttpRequest();}catch(trymicrosoft){try{request=new ActiveXObject("Msxml2.XMLHTTP");}catch(othermicrosoft){try{request=new ActiveXObject("Microsoft.XMLHTTP");}catch(failed){request=false;}}}if(!request)alert("Error initializing XMLHttpRequest!");var url=location.href.substring(0,location.href.lastIndexOf('/'))+"/get_geo.php?address="+encodeURIComponent(document.search.address.value);;request.onreadystatechange=process_geo;request.open('GET',url,true);request.send('');}function process_geo(){if(request.readyState==4&&request.status==200){var geo=eval(request.responseText);if(geo){document.search.lat.value=geo[1];document.search.lng.value=geo[0];setCookie("location_lat",geo[1],365);setCookie("location_lng",geo[0],365);setCookie("location_pesquisa",document.search.address.value,365);document.search.submit();}else
alert("Desculpa, não encontramos a morada indicada, tenta reescrever ou usa apenas o código postal completo ex: 1400-206");}}function success(position){var lat=position.coords.latitude;var lng=position.coords.longitude;setCookie("location_lat",lat,365);setCookie("location_lng",lng,365);document.search.lng.value=lng;document.search.lat.value=lat;try{request=new XMLHttpRequest();}catch(trymicrosoft){try{request=new ActiveXObject("Msxml2.XMLHTTP");}catch(othermicrosoft){try{request=new ActiveXObject("Microsoft.XMLHTTP");}catch(failed){request=false;}}}if(!request)alert("Error initializing XMLHttpRequest!");var url=location.href.substring(0,location.href.lastIndexOf('/'))+"/get_address.php?lat="+encodeURIComponent(lat)+"&lng="+encodeURIComponent(lng);request.onreadystatechange=process_address;request.open('GET',url,true);request.send('');}function process_address(){if(request.readyState==4&&request.status==200){document.getElementById('geo_icon').className='fa fa-spinner';document.search.address.value=request.responseText;setCookie("location_pesquisa",request.responseText,365);document.search.submit();}}function error(error){switch(error.code){case error.TIMEOUT:document.search.address.value=" time out,try again please ";break;case error.PERMISSION_DENIED:document.search.address.value=" you denied it,canceled ";break;case error.POSITION_UNAVAILABLE:document.search.address.value="sorry,detect failed";break;}document.getElementById('geo_icon').className='fa fa-map-marker';}function detect_auto(){if(navigator.geolocation){document.getElementById('geo_icon').className='fa fa-spinner';navigator.geolocation.getCurrentPosition(success,error);}else{alert("This feature requires your browser support html5");}}function setCookie(c_name,value,expiredays){var exdate=new Date();exdate.setDate(exdate.getDate()+expiredays);document.cookie=c_name+"="+escape(value)+((expiredays==null)?"":";expires="+exdate.toGMTString())+";path=/";}function getCookie(c_name){if(document.cookie.length>0){var c_start=document.cookie.indexOf(c_name+"=");if(c_start!=-1){c_start=c_start+c_name.length+1;var c_end=document.cookie.indexOf(";",c_start);if(c_end==-1)c_end=document.cookie.length;return unescape(document.cookie.substring(c_start,c_end));}}return""}function search_by_address(){if(document.search.lat.value==""){var address=document.search.address.value;if(address!="Insere o desconto a pesquisar..."&&address!=""&&address!="Escreve a tua morada"&&address!="Escreve a tua morada ou clica no botão azul")detect_geo_by_address();else if(navigator.geolocation)detect_auto();else{alert("address can't be empty");return false;}}else
document.search.submit();}function validaComprei(comprei){var mensagem='';if(comprei.titdesc.value==''){mensagem=mensagem+'Preenche o Título do Desconto!'}if(comprei.datavenc.value==''){mensagem=mensagem+'\nPreenche a Data de Vencimento!'}else if(comprei.datavenc.value<''){mensagem=mensagem+'\nA Data de Vencimento já passou, verifica novamente o teu cup?o por favor.'}if(comprei.quant.value==''){mensagem=mensagem+'\nPreenche a Quantidade!'}var n=comprei.quant.value;if(isNaN(parseInt(n))||!isFinite(n)||parseInt(n)!=n){mensagem=mensagem+'\nPor favor introduz um número correcto no campo Quantidade.'}if(comprei.lembrete.checked&&comprei.diasfim.value==''){mensagem=mensagem+'\nPreenche os Dias de Aviso!'}if(mensagem!=''){alert(mensagem);return false;}else{return true;}}function validaAmigo(enviaamigo){var filter=/^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/;var mensagem='';if(enviaamigo.nome.value==''){mensagem=mensagem+'Preenche o teu nome!'}if(filter.test(enviaamigo.email.value)==false){mensagem=mensagem+'\nO teu email não é válido!';}if(enviaamigo.nomeamigo.value==''){mensagem=mensagem+'\nPreenche o nome do teu amigo!'}if(filter.test(enviaamigo.emailamigo.value)==false){mensagem=mensagem+'\nO e-mail do teu amigo não é válido!';}if(mensagem!=''){alert(mensagem);return false;}else{return true;}}var r='';